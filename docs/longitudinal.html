<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Section 5 Longitudinal analyses | MINDMAP data platform tutorial</title>
  <meta name="description" content="This is a short tutorial on how to use the MINDMAP data platform.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Section 5 Longitudinal analyses | MINDMAP data platform tutorial" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a short tutorial on how to use the MINDMAP data platform." />
  <meta name="github-repo" content="https://github.com/ddoiron/mindmap_tutorial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 5 Longitudinal analyses | MINDMAP data platform tutorial" />
  
  <meta name="twitter:description" content="This is a short tutorial on how to use the MINDMAP data platform." />
  

<meta name="author" content="Dany Doiron">


<meta name="date" content="2019-03-11">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="cross-sectional.html">
<link rel="next" href="additional-reading.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MINDMAP data platform tutorial</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Tutorial overview</a></li>
<li class="chapter" data-level="2" data-path="login.html"><a href="login.html"><i class="fa fa-check"></i><b>2</b> Project set up</a><ul>
<li class="chapter" data-level="2.1" data-path="login.html"><a href="login.html#log-in-to-rstudio"><i class="fa fa-check"></i><b>2.1</b> Log in to RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="login.html"><a href="login.html#install-and-load-packages"><i class="fa fa-check"></i><b>2.2</b> Install and load packages</a></li>
<li class="chapter" data-level="2.3" data-path="login.html"><a href="login.html#log-in-to-opal"><i class="fa fa-check"></i><b>2.3</b> Log in to Opal</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="descriptives.html"><a href="descriptives.html"><i class="fa fa-check"></i><b>3</b> Descriptive statistics</a><ul>
<li class="chapter" data-level="3.1" data-path="descriptives.html"><a href="descriptives.html#inspect-the-dataframe"><i class="fa fa-check"></i><b>3.1</b> Inspect the dataframe</a></li>
<li class="chapter" data-level="3.2" data-path="descriptives.html"><a href="descriptives.html#measures-of-central-tendancy-and-variability"><i class="fa fa-check"></i><b>3.2</b> Measures of central tendancy and variability</a></li>
<li class="chapter" data-level="3.3" data-path="descriptives.html"><a href="descriptives.html#categorical-variables"><i class="fa fa-check"></i><b>3.3</b> Categorical variables</a></li>
<li class="chapter" data-level="3.4" data-path="descriptives.html"><a href="descriptives.html#graphs-and-plots"><i class="fa fa-check"></i><b>3.4</b> Graphs and plots</a></li>
<li class="chapter" data-level="3.5" data-path="descriptives.html"><a href="descriptives.html#pooled-statistics"><i class="fa fa-check"></i><b>3.5</b> Pooled statistics</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cross-sectional.html"><a href="cross-sectional.html"><i class="fa fa-check"></i><b>4</b> Cross-sectional analyses</a><ul>
<li class="chapter" data-level="4.1" data-path="cross-sectional.html"><a href="cross-sectional.html#linear-regression-models"><i class="fa fa-check"></i><b>4.1</b> Linear regression models</a><ul>
<li class="chapter" data-level="4.1.1" data-path="cross-sectional.html"><a href="cross-sectional.html#single-study"><i class="fa fa-check"></i><b>4.1.1</b> Single study</a></li>
<li class="chapter" data-level="4.1.2" data-path="cross-sectional.html"><a href="cross-sectional.html#pooled"><i class="fa fa-check"></i><b>4.1.2</b> Pooled</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="cross-sectional.html"><a href="cross-sectional.html#logistic-regression-models"><i class="fa fa-check"></i><b>4.2</b> Logistic regression models</a><ul>
<li class="chapter" data-level="4.2.1" data-path="cross-sectional.html"><a href="cross-sectional.html#single-study-1"><i class="fa fa-check"></i><b>4.2.1</b> Single study</a></li>
<li class="chapter" data-level="4.2.2" data-path="cross-sectional.html"><a href="cross-sectional.html#pooled-1"><i class="fa fa-check"></i><b>4.2.2</b> Pooled</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="longitudinal.html"><a href="longitudinal.html"><i class="fa fa-check"></i><b>5</b> Longitudinal analyses</a><ul>
<li class="chapter" data-level="5.1" data-path="longitudinal.html"><a href="longitudinal.html#wide-to-long-format"><i class="fa fa-check"></i><b>5.1</b> Wide to long format</a></li>
<li class="chapter" data-level="5.2" data-path="longitudinal.html"><a href="longitudinal.html#linear-mixed-models"><i class="fa fa-check"></i><b>5.2</b> Linear mixed models</a><ul>
<li class="chapter" data-level="5.2.1" data-path="longitudinal.html"><a href="longitudinal.html#continuous-outcome-normally-distributed"><i class="fa fa-check"></i><b>5.2.1</b> Continuous outcome (normally distributed)</a></li>
<li class="chapter" data-level="5.2.2" data-path="longitudinal.html"><a href="longitudinal.html#binary-outcome"><i class="fa fa-check"></i><b>5.2.2</b> Binary outcome</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="additional-reading.html"><a href="additional-reading.html"><i class="fa fa-check"></i><b>6</b> Additional reading</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MINDMAP data platform tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="longitudinal" class="section level1">
<h1><span class="header-section-number">Section 5</span> Longitudinal analyses</h1>
<p>This section provides simple examples of how to go about conducting longitudinal analyses of harmonized MINDMAP data.</p>
<div id="wide-to-long-format" class="section level2">
<h2><span class="header-section-number">5.1</span> Wide to long format</h2>
<p>Before we conduct longitudinal analyses, we need to transform each dataframe (GLOBE and RECORD) from wide to long format. The following scripts does this transformation for each study and saves the long-format dataframes as <em>globe_data_long</em> and <em>record_data_long</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># GLOBE: wide to long format</span>
globe_data_long &lt;-<span class="st"> </span>globe_data <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(var, value, <span class="op">-</span>entity_id, <span class="op">-</span>study) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">separate</span>(var, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;time&quot;</span>), <span class="dt">sep =</span> (<span class="st">&quot;_(?=[^_]+$)&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">spread</span>(variable, value)

<span class="co"># RECORD: wide to long format</span>
record_data_long &lt;-<span class="st"> </span>record_data <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(var, value, <span class="op">-</span>entity_id, <span class="op">-</span>study) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">separate</span>(var, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;time&quot;</span>), <span class="dt">sep =</span> (<span class="st">&quot;_(?=[^_]+$)&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">spread</span>(variable, value)</code></pre></div>
<p>Next, we combine GLOBE and RECORD long format dataframes into a pooled dataframe:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Pooled data: long format</span>
pooled_data_long &lt;-<span class="st"> </span><span class="kw">rbind</span>(globe_data_long, record_data_long)</code></pre></div>
<blockquote>
<p>Note: In the wide to long format transformation, the *_0* and *_1* suffixes, indicating baseline and follow up data collections are removed from the datasets.</p>
</blockquote>
</div>
<div id="linear-mixed-models" class="section level2">
<h2><span class="header-section-number">5.2</span> Linear mixed models</h2>
<div id="continuous-outcome-normally-distributed" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Continuous outcome (normally distributed)</h3>
<p>The <code>lmer()</code> function from the <code>lme4</code> allows us to fit linear mixed-effect models. In the example below, data for two time points (baseline and follow up 1) of the GLOBE study are fitted with body mass index as the outcome and age, sex, household income and smoking status as predictor variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lmm_bmi_globe &lt;-<span class="st"> </span><span class="kw">lmer</span>(phy_bmi_all <span class="op">~</span><span class="st"> </span>sdc_age <span class="op">+</span><span class="st"> </span>sdc_gender <span class="op">+</span><span class="st"> </span>sdc_income <span class="op">+</span><span class="st"> </span>lsb_smk_status <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>entity_id), <span class="dt">data =</span> globe_data_long)

<span class="kw">summary</span>(lmm_bmi_globe)</code></pre></div>
<p>The results in <em>lmm_bmi_globe</em> do not include p-values. To get p-values, the <code>Anova()</code> function can be used:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(lmm_bmi_globe)</code></pre></div>
<p>Below, the same model is fitted to the pooled dataset adding the study indicator variable to the formula.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lmm_bmi_pooled &lt;-<span class="st"> </span><span class="kw">lmer</span>(phy_bmi_all <span class="op">~</span><span class="st"> </span>sdc_age <span class="op">+</span><span class="st"> </span>sdc_gender <span class="op">+</span><span class="st"> </span>sdc_income <span class="op">+</span><span class="st"> </span>lsb_smk_status <span class="op">+</span><span class="st"> </span>study <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>entity_id), <span class="dt">data =</span> pooled_data_long)

<span class="kw">summary</span>(lmm_bmi_pooled)

<span class="kw">Anova</span>(lmm_bmi_pooled)</code></pre></div>
</div>
<div id="binary-outcome" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Binary outcome</h3>
<p>For binary outcomes, the <code>glmer()</code> function is used to fit a generalized linear mixed-effects model. The example below</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lmm_bmi_pooled_binary &lt;-<span class="st"> </span><span class="kw">glmer</span>(poh_sah_poor <span class="op">~</span><span class="st"> </span>sdc_age <span class="op">+</span><span class="st"> </span>sdc_gender <span class="op">+</span><span class="st"> </span>sdc_income <span class="op">+</span><span class="st"> </span>lsb_smk_status <span class="op">+</span><span class="st"> </span>study <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>entity_id), <span class="dt">data =</span> pooled_data_long_<span class="dv">2</span>, <span class="dt">family =</span> binomial)</code></pre></div>
<p>You will get a <em>Convergence warning</em> message. The following webpage provides troubleshooting for such problems: <a href="https://rstudio-pubs-static.s3.amazonaws.com/33653_57fc7b8e5d484c909b615d8633c01d51.html" class="uri">https://rstudio-pubs-static.s3.amazonaws.com/33653_57fc7b8e5d484c909b615d8633c01d51.html</a></p>
<p>In the example above, the <em>sdc_age</em> variable needs to be scalled. To do this, we used the <code>scale()</code> function and save the scalling resuls as a new variable called <em>sdc_age_sc</em>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pooled_data_long<span class="op">$</span>sdc_age_sc &lt;-<span class="st"> </span><span class="kw">scale</span>(pooled_data_long<span class="op">$</span>sdc_age) </code></pre></div>
<p>This variable then replaces the original <em>sdc_age</em> variable:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lmm_bmi_pooled_binary &lt;-<span class="st"> </span><span class="kw">glmer</span>(poh_sah_poor <span class="op">~</span><span class="st"> </span>sdc_age_sc <span class="op">+</span><span class="st"> </span>sdc_gender <span class="op">+</span><span class="st"> </span>sdc_income <span class="op">+</span><span class="st"> </span>lsb_smk_status <span class="op">+</span><span class="st"> </span>study <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>entity_id), <span class="dt">data =</span> pooled_data_long, <span class="dt">family =</span> binomial)

<span class="kw">summary</span>(lmm_bmi_pooled_binary)</code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cross-sectional.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="additional-reading.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-longitudinal.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["mindmap-tutorial.pdf", "mindmap-tutorial.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
